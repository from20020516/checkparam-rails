<p>
  <%= Time.now %><br>
  <%= current_user.lang %> <%= Job.find(current_user.jobid).ja %>
</p>

<div class="form-group">
  <%= form_with scope: :equipset do |f| %>
  <div class="form-group row">
    <label for="equipset_main" class="col-2 col-form-label"><%= image_tag '/icons/48/16622.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:main, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**0).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_sub" class="col-2 col-form-label"><%= image_tag '/icons/48/12332.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:sub, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**1).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_range" class="col-2 col-form-label"><%= image_tag '/icons/48/17174.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:range, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**2).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_ammo" class="col-2 col-form-label"><%= image_tag '/icons/48/17326.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:ammo, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**3).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_head" class="col-2 col-form-label"><%= image_tag '/icons/48/12523.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:head, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**4).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_neck" class="col-2 col-form-label"><%= image_tag '/icons/48/13074.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:neck, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**9).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_ear1" class="col-2 col-form-label"><%= image_tag '/icons/48/13358.png' %></label>
    <div class="col-10">
       <%= f.collection_select(:ear1, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**11).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_ear2" class="col-2 col-form-label"><%= image_tag '/icons/48/13358.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:ear2, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**12).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_body" class="col-2 col-form-label"><%= image_tag '/icons/48/12551.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:body, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**5).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_hands" class="col-2 col-form-label"><%= image_tag '/icons/48/12679.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:hands, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**6).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_ring1" class="col-2 col-form-label"><%= image_tag '/icons/48/13505.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:ring1, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**13).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_ring2" class="col-2 col-form-label"><%= image_tag '/icons/48/13505.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:ring2, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**13).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_back" class="col-2 col-form-label"><%= image_tag '/icons/48/13606.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:back, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**15).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_waist" class="col-2 col-form-label"><%= image_tag '/icons/48/13215.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:waist, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**10).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_legs" class="col-2 col-form-label"><%= image_tag '/icons/48/12807.png' %></label>
    <div class="col-10">
     <%= f.collection_select(:legs, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**7).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="equipset_feet" class="col-2 col-form-label"><%= image_tag '/icons/48/12935.png' %></label>
    <div class="col-10">
      <%= f.collection_select(:feet, Item.where('job & ? > 0 and slot & ? > 0', 2**current_user.jobid, 2**8).order(current_user.lang), :id, current_user.lang, {include_blank: true}, {class: "form-control"}) %>
    </div>
  </div>
<% end %>
</div>
<script>
  var initSet = {
    equipset_main: 16622, equipset_sub: 12332, equipset_range: 17174, equipset_ammo: 17326,
    equipset_head: 12523, equipset_neck: 13074, equipset_ear1: 13358, equipset_ear2: 13358,
    equipset_body: 12551, equipset_hands: 12679, equipset_ring1: 13505, equipset_ring2: 13505,
    equipset_back: 13606, equipset_waist: 13215, equipset_legs: 12807, equipset_feet:12935,
  }
  var equipset = document.querySelector("#equipset")
  equipset.addEventListener("change", function(data) {
    equipset.querySelector(`label[for="${data.target.id}"] img`).src = `/icons/48/${data.target.value || initSet[data.target.id]}.png`;
    document.querySelector(`#${data.target.id} img`).src = `/icons/48/${data.target.value || 0}.png`;
  }, {passive: true});  
</script>